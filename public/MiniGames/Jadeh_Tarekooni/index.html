<head>
    <style> body {
        margin: 0;
    } </style>

    <script src="//unpkg.com/react/umd/react.production.min.js"></script>
    <script src="//unpkg.com/react-dom/umd/react-dom.production.min.js"></script>
    <script src="//unpkg.com/babel-standalone"></script>
    <link href="./style.css" rel="stylesheet">
    <script src="//unpkg.com/react-force-graph-2d"></script>
    <!--<script src="../../src/packages/react-force-graph-3d/dist/react-force-graph-3d.js"></script>-->
</head>

<body>
<button id="graph1" class="btn btn-blue btn-big">graph 1</button>
<button id="graph2" class="btn btn-blue btn-big">graph 2</button>
<button id="graph3" class="btn btn-blue btn-big">graph 3</button>
<div id="graph"></div>

<script type="text/jsx">
    document.getElementById("graph1").addEventListener("click", graphFunc1);
    document.getElementById("graph2").addEventListener("click", graphFunc2);
    document.getElementById("graph3").addEventListener("click", graphFunc3);
    const {useRef} = React;
    function graphFunc1() {
        show('./a.json',0,9);
    }
    function graphFunc2() {
        show('./b.json',0,21);
    }
    function graphFunc3() {
        show('./c.json',0,27);
    }


    function show(file,f,l){
        fetch(file).then(res => res.json()).then(data => {
            data.nodes[f].color = "#026f0a"
            data.nodes[l].color = "#bd0000"
            const FocusGraph = () => {
                const fgRef = useRef();
                let mainNode = data.nodes[0];
                console.log(mainNode);
                const handleClick = link => {
                    let node = data.nodes.find(o => o.id === link.target.id);
                    if (mainNode.id === node.id )
                        node = data.nodes.find(o => o.id === link.source.id);
                    console.log(node);
                    mainNode = node;
                    link.color = "#026f0a"
                    node.color = "#026f0a"
                    data.nodes[l].color="#bd0000"
                    const distance = 10;
                    const distRatio = 1 + distance / Math.hypot(node.x, node.y);
                    console.log(distRatio);
                    fgRef.current.centerAt(node.x , node.y, 1000);
                    fgRef.current.zoom(40);

                };

                return <ForceGraph2D
                    ref={fgRef}
                    graphData={data}
                    nodeLabel="id"
                    nodeAutoColorBy="group"
                    onLinkClick={handleClick}
                />;
            };
            ReactDOM.render(
                <FocusGraph/>,
                document.getElementById('graph')
            );
        });
    }

</script>
</body>
